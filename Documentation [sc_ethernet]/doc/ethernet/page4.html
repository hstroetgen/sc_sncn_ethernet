

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SMI Component API &mdash; XMOS Layer 2 Ethernet MAC Component v documentation</title>

    <link rel="stylesheet" href=".static/pygments.css" type="text/css" />
    <link rel="stylesheet" href=".static/globals.css"  type="text/css" />
    <link rel="stylesheet" href=".static/ui.css" type="text/css" />
    <link rel="stylesheet" href=".static/app.css"  type="text/css" />
    <link rel="stylesheet" href=".static/mobile.css"  type="text/css" />
    <link rel="stylesheet" href=".static/xde.css"
    type="text/css" /><script type="text/javascript" src=".static/scripts.js"></script>
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src=".static/jquery.js"></script>
    <script type="text/javascript" src=".static/underscore.js"></script>
    <script type="text/javascript" src=".static/doctools.js"></script>
    <link rel="top" title="XMOS Layer 2 Ethernet MAC Component v documentation" href="index.html" />
    <link rel="next" title="XMOS Development Board Support Component" href="page5.html" />
    <link rel="prev" title="Ethernet API" href="page3.html" /> 
  </head>
  <body class="xde indented-content" onload="prepareContents();">  
          <div id="body">
             <div id="content">
             <h1>SMI Component API</h1>

             <div class='columns'>
            
  <p>The module <tt class="docutils literal"><span class="pre">module_ethernet_smi</span></tt>
is written to support SMI independently of the MII interface.
Typically, Ethernet PHYs are configured on reset automatically, but the SMI
interface may be useful for setting and testing register values
dynamically.</p>
<p>There are two ways to interface SMI:
using a pair of 1-bit ports, or using
a single multi-bit port.</p>
<h2 class="topic" id="configuration-defines">Configuration Defines</h2>
<div><p>These defines can either be set in <tt class="docutils literal"><span class="pre">ethernet_conf.h</span></tt> or
<tt class="docutils literal"><span class="pre">smi_conf.h</span></tt> from within your application directory.</p>
<p><strong>SMI_COMBINE_MDC_MDIO</strong></p>
<blockquote>
<div><p>This define should be set to 1 if you want to combine MDC and MDIO
onto a single bit port.</p>
</div></blockquote>
<p><strong>SMI_MDC_BIT</strong></p>
<blockquote>
<div><p>This defines the bit number on the shared port where the MDC line is.
Only define this if you have a port that drives both MDC and MDIO.</p>
</div></blockquote>
<p><strong>SMI_MDIO_BIT</strong></p>
<blockquote>
<div><p>This defines the bit number on the shared port where the MDIO line is.
Only define this if you have a port that drives both MDC and MDIO.</p>
</div></blockquote>
</div><h2 class="topic" id="data-structures">Data Structures</h2>
<div><ul class='lib'><li class="type">
<h2 id="smi_interface_t">
<tt class="descname">smi_interface_t</tt></h2>
<p>Structure containing resources required for the SMI ethernet phy interface.</p>
<p>This structure can be filled in two ways. One indicate that the SMI interface is connected using two 1-bit port, the other indicates that the interface is connected using a single multi-bit port.</p>
<p>If used with two 1-bit ports, set the <tt class="docutils literal"><span class="pre">phy_address</span></tt>, <tt class="docutils literal"><span class="pre">p_smi_mdio</span></tt> and <tt class="docutils literal"><span class="pre">p_smi_mdc</span></tt> as normal.</p>
<p>If SMI_COMBINE_MDC_MDIO is 1 then <tt class="docutils literal"><span class="pre">p_smi_mdio</span></tt> is ommited and <tt class="docutils literal"><span class="pre">p_mdc</span></tt> is assumbed to multibit port containing both mdio and mdc.</p>
<p><strong>Structure Members:</strong></p>
<ul class='lib'><li class="member">
<h2 id="smi_interface_t.phy_address">
int <tt class="descname">phy_address</tt></h2>
<p>Address of PHY, typically 0 or 0x1F.</p>
</li>

<li class="member">
<h2 id="smi_interface_t.p_smi_mdio">
port <tt class="descname">p_smi_mdio</tt></h2>
<p>MDIO port.</p>
</li>

<li class="member">
<h2 id="smi_interface_t.p_smi_mdc">
port <tt class="descname">p_smi_mdc</tt></h2>
<p>MDC port.</p>
</li>

</ul></li>

</ul></div><h2 class="topic" id="phy-api">Phy API</h2>
<div><ul class='lib'><li class="function">
<h2 id="smi_init">
void <tt class="descname">smi_init</tt><big>(</big><a class="reference" href="#smi_interface_t" title="smi_interface_t"><span>smi_interface_t</span></a><em>&nbsp;&amp;smi</em><big>)</big></h2>
<p>Function that configures the SMI ports.</p>
<p>No clock block is needed. Note that there is no deinit function.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>smi</h2>
<p>structure containing the clock and data ports for SMI.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="eth_phy_config">
void <tt class="descname">eth_phy_config</tt><big>(</big>int<em>&nbsp;eth100</em>, <a class="reference" href="#smi_interface_t" title="smi_interface_t"><span>smi_interface_t</span></a><em>&nbsp;&amp;smi</em><big>)</big></h2>
<p>Function that configures the Ethernet PHY explicitly to set to autonegotiate.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>If</h2>
<p>eth100 is non-zero, 100BaseT is advertised to the link peer Full duplex is always advertised</p>
</li>
<li><h2>smi</h2>
<p>structure that defines the ports to use for SMI</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="eth_phy_config_noauto">
void <tt class="descname">eth_phy_config_noauto</tt><big>(</big>int<em>&nbsp;eth100</em>, <a class="reference" href="#smi_interface_t" title="smi_interface_t"><span>smi_interface_t</span></a><em>&nbsp;&amp;smi</em><big>)</big></h2>
<p>Function that configures the Ethernet PHY to not autonegotiate.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>If</h2>
<p>eth100 is non-zero, it is set to 100, else to 10 Mbits/s</p>
</li>
<li><h2>smi</h2>
<p>structure that defines the ports to use for SMI</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="eth_phy_loopback">
void <tt class="descname">eth_phy_loopback</tt><big>(</big>int<em>&nbsp;enable</em>, <a class="reference" href="#smi_interface_t" title="smi_interface_t"><span>smi_interface_t</span></a><em>&nbsp;&amp;smi</em><big>)</big></h2>
<p>Function that can enable or disable loopback in the phy.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>enable</h2>
<p>boolean; set to 1 to enable loopback, or 0 to disable loopback.</p>
</li>
<li><h2>smi</h2>
<p>structure containing the ports</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="eth_phy_id">
int <tt class="descname">eth_phy_id</tt><big>(</big><a class="reference" href="#smi_interface_t" title="smi_interface_t"><span>smi_interface_t</span></a><em>&nbsp;&amp;smi</em><big>)</big></h2>
<p>Function that returns the PHY identification.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>smi</h2>
<p>structure containing the ports</p>
</li>
</ul>
</div><h3 class="nosecnum compact" id="">Returns</h3>
<div><p>the 32-bit identifier.</p>
</div></li>

<li class="function">
<h2 id="smi_check_link_state">
int <tt class="descname">smi_check_link_state</tt><big>(</big><a class="reference" href="#smi_interface_t" title="smi_interface_t"><span>smi_interface_t</span></a><em>&nbsp;&amp;smi</em><big>)</big></h2>
<p>Function that polls whether the link is alive.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>smi</h2>
<p>structure containing the ports</p>
</li>
</ul>
</div><h3 class="nosecnum compact" id="">Returns</h3>
<div><p>non-zero if the link is alive; zero otherwise.</p>
</div></li>

</ul></div>

             </div>
             </div>


          </div>

          <div>
             <!--seealsos-->
          </div><div id="local_seealso">
             <h1>See Also</h1>
             <ul class="iconmenu">
             <li><a href="page0.html">Ethernet Layer 2 MAC Overview</a></li>
             <li><a href="page1.html">Ethernet Mac Description</a></li>
             <li><a href="page2.html">Ethernet Programming Guide</a></li>
             <li><a href="page3.html">Ethernet API</a></li>
             <li><a href="page5.html">XMOS Development Board Support Component</a></li>
             </ul>
          </div>
    <div class="footer">
    </div>
  </body>
</html>